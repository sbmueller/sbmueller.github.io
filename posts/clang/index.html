<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://sbmueller.github.io/ name=base><title>
            
                What I Learned: Clang Tools
            
        </title><meta content="What I Learned: Clang Tools" property=og:title><link href=https://sbmueller.github.io/icon/favicon.png rel=icon type=image/png><link href=https://sbmueller.github.io/fonts.css rel=stylesheet><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link href=https://sbmueller.github.io/theme/light.css rel=stylesheet><link href=https://sbmueller.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://sbmueller.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://sbmueller.github.io/main.css media=screen rel=stylesheet><body><div class=left-content></div><div class=content><style>.avatar{vertical-align:middle;border-radius:50%;max-width:150px;height:auto}#wrapper{clear:both;text-align:center;width:100%}</style><nav><div class=left-nav><a href=https://sbmueller.github.io/>sbmueller</a><div class=socials><a class=social href=https://github.com/sbmueller/ rel=me> <img alt=github src=https://sbmueller.github.io/icons/social/github.svg> </a><a class=social href=https://www.linkedin.com/in/sbmueller/ rel=me> <img alt=linkedin src=https://sbmueller.github.io/icons/social/linkedin.svg> </a></div></div><div class=right-nav><a href=https://sbmueller.github.io/about style=margin-right:.5em>/about</a><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://sbmueller.github.io/icons/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://sbmueller.github.io/icons/moon.svg> </a><script>updateItemToggleTheme()</script></div></nav><div id=wrapper><a href=https://sbmueller.github.io/> <img src="https://avatars.githubusercontent.com/u/7465688?v=4" class=avatar> </a></div><div data-selector="main article p" class=visible-element-observer-root><main><article><div class=title><div class=page-header>What I Learned: Clang Tools</div><div class=meta>Posted on <time>2020-06-10</time></div></div><section class=body><p>I have recently pivoted professionally and became a C++ developer. Due to that change, I wanted to revisit my tooling landscape that I use for everyday development. In particular, I want to share how I keep my code quality up without any manual effort and at zero dynamic cost by using static code analysis.<h1 id=static-code-analysis-linting>Static Code Analysis/Linting</h1><p>To perform a static code analysis means to search for programming errors and issues before any code is executed (like in a unit test). It's the first measure that the computer itself can take to improve code quality. The best thing is: static code analysis can run automatically once set up with your IDE and therefore provide checks and guidance with no additional effort on the programmer's side.<h2 id=set-up>Set-Up</h2><p>There are various static code analyzing tools for all kinds of programming languages, but I'm going to focus on <code>clang-tidy</code> here. It's part of the LLVM toolchain and a standalone tool that you can use by just executing<pre style=color:#abb2bf;background-color:#282c34><code><span>clangtidy main.cpp
</span></code></pre><p>However, since manual checks are inconvenient and can be forgotten, it is recommended to integrate <code>clang-tidy</code> into your IDE. I'm using vim as my IDE and make use of a plugin called <a href=https://github.com/dense-analysis/ale>ALE</a>. This plugin just makes sure to run any analyzing tools of my choice asynchronously in the background while I'm coding and I'm sure there is similar functionality in other IDEs as well. ALE automatically checks code on open and save actions but can be configured more precisely.<p>As part of the LLVM toolchain, <code>clang-tidy</code> needs a compilation database to work properly. This is a small JSON file that specifies which file is going to be compiled with what compiler command, to identify the C++ standard used, the directories included, etc. Only with that information, reliable linting is possible. For CMake projects, the creation of such a <code>compile_commands.json</code> file is straightforward, by setting the CMake variable <code>CMAKE_CREATE_COMPILATION_DATABASE</code> to <code>ON</code>. The file will be created in the build directory and I usually symlink it into the project root, since all clang tools search for it in the working directory and its parent directories.<h3 id=cmake>CMake</h3><p>It is possible to set up CMake to run <code>clang-tidy</code> during the build process with CMake 3.7.2 or later. Just set the variable <code>CMAKE_CXX_CLANG_TIDY</code> to <code>"clang-tidy;-checks=*"</code>.<h2 id=example>Example</h2><p>Let's assume this very basic definition of a C++ class:<pre class=language-cpp data-lang=cpp style=color:#abb2bf;background-color:#282c34><code class=language-cpp data-lang=cpp><span style=color:#c678dd>class </span><span style=color:#e5c07b>Base </span><span>{
</span><span style=color:#c678dd>public</span><span>:
</span><span>  </span><span style=color:#61afef>Base</span><span>();
</span><span>  </span><span style=color:#61afef>~Base</span><span>();
</span><span>  </span><span style=color:#61afef>Base</span><span>(</span><span style=color:#c678dd>const</span><span> Base &</span><span style=color:#e06c75>other</span><span>);
</span><span>};
</span></code></pre><p>Let's execute <code>clang-tidy</code> in the terminal here. I enabled all checks for this example, which normally will return a lot of output when executed on a bigger source code file:<pre style=color:#abb2bf;background-color:#282c34><code><span>$ clang-tidy --checks="*" main.cpp
</span><span>2 warnings generated.
</span><span>/Users/senpo/src/test/main.cpp:1:7: warning: class 'Base' defines a non-default destructor and a copy constructor but does not define a copy assignment operator, a move constructor or a move assignment operator [hicpp-special-member-functions]
</span><span>class Base {
</span><span>      ^
</span></code></pre><p><code>clang-tidy</code> is warning us that we are violating the <a href=https://en.cppreference.com/w/cpp/language/rule_of_three>Rule of Three</a>, which tells us if a class has a user-defined copy constructor, copy assignment operator or destructor, all three of them shall be implemented. The rule of five extends this statement for the move constructor and the move assignment operator. This issue will probably not raise a compilation or runtime error, but as best practice can avoid exhausting bug searches in the future. So even after compilation and unit-testing, this kind of issue would have remained undetected without linting!<p>This is great and we can improve our code from here. With IDE integration, you even get these messages directly while writing the code, without running <code>clang-tidy</code> manually:<p><img alt="clang tools in vim" src=/images/clang.png><h1 id=code-formatting>Code Formatting</h1><p>Besides linting, clang also offers a tool to properly format source code files, named <code>clang-format</code>. By running it on a file, it will output a formatted version of that source code file. To directly change the content of the file, the <code>-i</code> flag can be used. Let's look at this example:<pre class=language-cpp data-lang=cpp style=color:#abb2bf;background-color:#282c34><code class=language-cpp data-lang=cpp><span style=color:#c678dd>#include</span><span style=color:#98c379>&LTiostream>
</span><span>
</span><span style=color:#c678dd>int </span><span style=color:#61afef>main</span><span>(){
</span><span>
</span><span>    
</span><span>    std::cout << </span><span style=color:#98c379>"Hello, "
</span><span>      << </span><span style=color:#98c379>"World!" </span><span><< std::endl;
</span><span>    </span><span style=color:#c678dd>return
</span><span>      </span><span style=color:#d19a66>0</span><span>; }
</span></code></pre><p>That's a badly formatted code. Let's see what <code>clang-format</code> suggests:<pre style=color:#abb2bf;background-color:#282c34><code><span>$ clang-format main.cpp
</span><span>#include &LTiostream>
</span><span>
</span><span>int main() {
</span><span>
</span><span>  std::cout << "Hello, " << "World!" << std::endl;
</span><span>  return 0;
</span><span>}
</span></code></pre><p>Various coding styles can be set via the --style flag, including own definitions that are usually stored in a <code>.clang-format</code> file in the project root. For example, have a look at the <a href=https://github.com/gnuradio/gnuradio/blob/master/.clang-format>GNU Radio clang-format file</a>.<p>As with linting, this tool can be directly integrated into your IDE, for instance, to format with a hotkey or to format before each save. This will make sure you always stay compliant with your coding guidelines without any effort from your side!</section></article></main></div><hr><center><small>Copyright © 2025 Sebastian Müller. All rights reserved.</small></center></div><div class=right-content></div>